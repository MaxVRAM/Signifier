pcm.!default {
  type asym
  playback.pcm "SpeakerAndLoop"
  capture.pcm "hw:1,1"
}

ctl.!default {
  type hw
  card 0
}

# PLAYBACK and LOOPBACK interface
pcm.SpeakerAndLoop {
  type plug
  slave.pcm MultiCh
  route_policy "duplicate"
}

# Virtual multichannel device:
# 2 x Headphones channels, 2 x Loopback channels
pcm.MultiCh {
  type multi
  slaves.a.pcm pcm.MixerHeadphones
  slaves.a.channels 2
  slaves.b.pcm pcm.MixerLoopback
  slaves.b.channels 2
  bindings.0.slave a
  bindings.0.channel 0
  bindings.1.slave a
  bindings.1.channel 1
  bindings.2.slave b
  bindings.2.channel 0
  bindings.3.slave b
  bindings.3.channel 1
}

# Headphones device mixer
pcm.MixerHeadphones {
  type dmix
  ipc_key 1024
  slave {
    pcm "hw:0,0"
    rate 48000
    periods 128
    period_time 0
    period_size 1024
    buffer_size 2048
  }
}

# Loopback device mixer
pcm.MixerLoopback {
  type dmix
  ipc_key 1025
  slave {
    pcm "hw:1,0"
    rate 48000
    periods 128
    period_time 0
    period_size 1024
    buffer_size 2048
  }
}