{
    "general": {
        "hostname": "mmwSigB",
        "process_loop_sleep": 0.001
    },
    "metrics": {
        "enabled": true,
        "debug": true,
        "start_delay": 0,
        "target_gateway": "localhost:9091",
        "server_port": 9092,
        "job_name": "signifier",
        "push_period": 1,
        "timeout": 0.1
    },
    "mapper": {
        "enabled": true,
        "debug": true,
        "start_delay": 0,
        "rules": [
            {
                "source": {
                    "module": "analysis",
                    "name": "analysis_peak",
                    "range": [
                        0,
                        1
                    ]
                },
                "destination": {
                    "module": "leds",
                    "name": "leds_brightness",
                    "range": [
                        0,
                        1
                    ],
                    "duration": 100
                }
            },
            {
                "source": {
                    "module": "bluetooth",
                    "name": "bluetooth_signal_max",
                    "range": [
                        0.2,
                        0.5
                    ]
                },
                "destination": {
                    "module": "leds",
                    "name": "leds_saturation",
                    "range": [
                        1,
                        0
                    ],
                    "duration": 1000
                }
            }
        ]
    },
    "leds": {
        "enabled": true,
        "debug": true,
        "port": "/dev/ttyACM0",
        "backup_port": "/dev/ttyACM1",
        "baud": 38400,
        "start_delay": 0,
        "update_ms": 30,
        "duration_multiplier": 5,
        "sources": {
            "leds_arduino_state": {
                "type": "info",
                "description": "Current state of serial communicate with Arduino."
            },
            "leds_loop_duration": {
                "type": "gauge",
                "description": "Previous loop duration in milliseconds."
            },
            "leds_serial_rx_window": {
                "type": "gauge",
                "description": "Number of milliseconds Arduino serial rx window is open for."
            }
        },
        "destinations": {
            "leds_update_ms": {
                "type": "gauge",
                "command": "l",
                "min": 10,
                "max": 200,
                "default": 30,
                "description": "Target Arduino loop length in ms."
            },
            "leds_brightness": {
                "type": "gauge",
                "command": "B",
                "min": 3,
                "max": 255,
                "default": 0,
                "description": "Brightness scaling of entire LED strip."
            },
            "leds_saturation": {
                "type": "gauge",
                "command": "S",
                "min": 0,
                "max": 255,
                "default": 255,
                "description": "Colour saturation of future pixel writes."
            },
            "leds_hue": {
                "type": "gauge",
                "command": "H",
                "min": 0,
                "max": 255,
                "default": 195,
                "description": "Hue value of future pixel writes."
            },
            "leds_noise": {
                "type": "gauge",
                "command": "N",
                "min": 0,
                "max": 255,
                "default": 0,
                "description": "Amount of white pixel noise blended over the strip."
            }
        }
    },
    "bluetooth": {
        "enabled": true,
        "debug": true,
        "start_delay": 0,
        "scan_dur": 3,
        "signal_threshold": 0.002,
        "remove_after": 15,
        "sources": {
            "bluetooth_num_devices": {
                "type": "gauge",
                "description": "Total number of nearby BLE devices."
            },
            "bluetooth_signal_total": {
                "type": "gauge",
                "description": "Sum of nearby BLE signal strengths."
            },
            "bluetooth_signal_mean": {
                "type": "gauge",
                "description": "Mean of nearby BLE signal strengths."
            },
            "bluetooth_signal_std": {
                "type": "gauge",
                "description": "Standard deviation of BLE signal strength."
            },
            "bluetooth_signal_max": {
                "type": "gauge",
                "description": "Value of strongest BLE device signal."
            },
            "bluetooth_activity_total": {
                "type": "gauge",
                "description": "Total absolute difference of BLE device signals each tick."
            },
            "bluetooth_activity_mean": {
                "type": "gauge",
                "description": "Average activity of nearby BLE devices."
            },
            "bluetooth_activity_std": {
                "type": "gauge",
                "description": "Standard deviation of BLE device activity."
            },
            "bluetooth_activity_max": {
                "type": "gauge",
                "description": "Activity value of most active BLE device."
            }
        },
        "destinations": {}
    },
    "analysis": {
        "enabled": true,
        "debug": true,
        "start_delay": 0,
        "input_device": "default",
        "sample_rate": 48000,
        "dtype": "int16",
        "buffer": 1024,
        "gain": 1.0,
        "sources": {
            "analysis_peak": {
                "type": "gauge",
                "description": "Peak amplitude of audio signal in each buffer."
            },
            "analysis_buffer_size": {
                "type": "gauge",
                "description": "Number of samples read in input buffer."
            },
            "analysis_buffer_ms": {
                "type": "gauge",
                "description": "Duration of buffer read in milliseconds."
            }
        },
        "destinations": {}
    },
    "composition": {
        "enabled": true,
        "debug": false,
        "start_delay": 0,
        "output_device": "default",
        "sample_rate": 48000,
        "bit_size": -16,
        "buffer": 1024,
        "base_path": "/home/pi/Signifier/media/audio/",
        "force_collection": null,
        "valid_extensions": [
            "wav"
        ],
        "strict_distribution": false,
        "volume": 0.7,
        "fade_in_ms": 1000,
        "fade_out_ms": 2000,
        "max_playtime": 60,
        "default_pool_size": 12,
        "destinations": {
            "composition_volume_main": {
                "type": "gauge",
                "min": 0.1,
                "max": 1.0,
                "default": 0.7,
                "description": "Overall volume of the audio output."
            },
            "composition_volume_speed": {
                "type": "gauge",
                "min": 0,
                "max": 10,
                "default": 5,
                "description": "Volume job's rate of modulation."
            },
            "composition_volume_weight": {
                "type": "gauge",
                "min": -1.0,
                "max": 1.0,
                "default": 0,
                "description": "Volume job's weighting: negative/positive = softer/louder."
            },
            "composition_target_level": {
                "type": "gauge",
                "min": 1,
                "max": 8,
                "default": 3,
                "description": "Target number of concurrent audio clips."
            }
        },
        "sources": {
            "composition_collection": {
                "type": "info",
                "description": "Name of active audio clip collection."
            },
            "composition_clips": {
                "type": "array",
                "subtype": "info",
                "description": "Name of currently selected audio clips."
            },
            "composition_volume": {
                "type": "array",
                "subtype": "gauge",
                "description": "Current mixer channel volumes."
            },
            "composition_active": {
                "type": "array",
                "subtype": "gauge",
                "description": "Active playback state of clips."
            },
            "composition_play_count": {
                "type": "array",
                "subtype": "gauge",
                "description": "Number times clip has been activated since collection change."
            },
            "composition_play_time": {
                "type": "array",
                "subtype": "gauge",
                "description": "Duration clip has played for current activation."
            }
        },
        "categories": {
            "oneshot": {
                "threshold": 0,
                "is_loop": false,
                "loop_range": [
                    4,
                    8
                ]
            },
            "short": {
                "threshold": 5,
                "is_loop": false,
                "loop_range": [
                    2,
                    4
                ]
            },
            "medium": {
                "threshold": 10,
                "is_loop": false,
                "loop_range": [
                    2,
                    4
                ]
            },
            "loop": {
                "threshold": 30,
                "is_loop": false,
                "loop_range": [
                    0,
                    2
                ]
            }
        },
        "jobs": {
            "collection": {
                "enabled": true,
                "timer": 128,
                "fail_retry_delay": 5,
                "parameters": {
                    "pool_size": 12,
                    "start_clips": 1,
                    "collections": []
                },
                "description": "Schedule to change the active collection."
            },
            "clip_selection": {
                "enabled": true,
                "timer": 16,
                "parameters": {
                    "quiet_level": 3,
                    "busy_level": 8
                },
                "description": "Schedule add/subtract active clips based on target 'level'."
            },
            "volume": {
                "enabled": true,
                "timer": 1,
                "parameters": {
                    "speed": 5,
                    "weight": 0
                },
                "description": "Schedule to random modulate volume levels of active clips."
            }
        }
    }
}